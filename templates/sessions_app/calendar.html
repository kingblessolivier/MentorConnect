{% extends 'dashboard/base_dashboard.html' %}

{% block title %}Mentor Calendar - {{ mentor.get_full_name }}{% endblock %}

{% block dashboard_content %}
<div class="dashboard-header">
    <div>
        <h1>Mentor Schedule</h1>
        <p class="text-muted">View available slots and booked sessions for {{ mentor.get_full_name }}</p>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <h3>Available Slots</h3>
        {% regroup availabilities by get_day_of_week_display as day_list %}
        {% for day in day_list %}
        <div class="mb-4">
            <h4 class="mb-2">{{ day.grouper }}</h4>
            {% for slot in day.list %}
            <div class="p-3 mb-2 rounded" style="background: var(--background-color);">
                <div class="flex items-center gap-3">
                    <i data-feather="clock" class="text-primary"></i>
                    <span>{{ slot.start_time|time:"H:i" }} - {{ slot.end_time|time:"H:i" }}</span>
                </div>
                {% if slot.location_name or slot.address %}
                <div class="text-muted mt-1" style="font-size: 0.95em;">
                    <i data-feather="map-pin" style="width:14px;"></i>
                    {{ slot.location_name }}{% if slot.location_name and slot.address %}, {% endif %}{{ slot.address }}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% empty %}
        <div class="text-center py-5">
            <i data-feather="clock" style="width: 48px; height: 48px; color: var(--text-muted);"></i>
            <h3 class="mt-3">No availability set</h3>
        </div>
        {% endfor %}
        <hr>
        <h3>Upcoming Booked Sessions</h3>
        {% if booked_sessions %}
        <ul class="list-group">
            {% for session in booked_sessions %}
            <li class="list-group-item">
                <div class="flex items-center gap-3">
                    <i data-feather="calendar"></i>
                    <span>{{ session.scheduled_time|date:"M d, Y H:i" }}</span>
                    <span class="ml-2">{{ session.title }}</span>
                </div>
                {% if session.location_name or session.address %}
                <div class="text-muted mt-1" style="font-size: 0.95em;">
                    <i data-feather="map-pin" style="width:14px;"></i>
                    {{ session.location_name }}{% if session.location_name and session.address %}, {% endif %}{{ session.address }}
                </div>
                {% endif %}
                {% if session.description %}
                <div class="mt-1">{{ session.description }}</div>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <div class="text-center py-4 text-muted">No upcoming sessions.</div>
        {% endif %}
    </div>
</div>
{% endblock %}
