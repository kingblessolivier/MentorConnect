{% extends 'dashboard/base_dashboard.html' %}

{% block title %}My Availability - {{ SITE_NAME }}{% endblock %}

{% block dashboard_content %}
<div class="dashboard-header">
    <div>
        <h1>My Availability</h1>
        <p class="text-muted">Set your available times for mentorship sessions</p>
    </div>
    <a href="{% url 'sessions_app:add_availability' %}" class="btn btn-primary">
        <i data-feather="plus"></i> Add Time Slot
    </a>
</div>

<div class="card">
    <div class="card-body">
        {% regroup availabilities by get_day_of_week_display as day_list %}
        {% for day in day_list %}
        <div class="mb-4">
            <h4 class="mb-2">{{ day.grouper }}</h4>
            {% for slot in day.list %}
            <div class="flex justify-between items-center p-3 mb-2 rounded" style="background: var(--background-color);">
                <div>
                    <div class="flex items-center gap-3">
                        <i data-feather="clock" class="text-primary"></i>
                        <span>{{ slot.start_time|time:"H:i" }} - {{ slot.end_time|time:"H:i" }}</span>
                    </div>
                    {% if slot.location_name or slot.address %}
                    <div class="text-muted mt-1" style="font-size: 0.95em;">
                        <i data-feather="map-pin" style="width:14px;"></i>
                        {{ slot.location_name }}{% if slot.location_name and slot.address %}, {% endif %}{{ slot.address }}
                    </div>
                    {% endif %}
                </div>
                <form method="post" action="{% url 'sessions_app:delete_availability' slot.pk %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-ghost text-danger" onclick="return confirm('Remove this time slot?')">
                        <i data-feather="trash-2"></i>
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
        {% empty %}
        <div class="text-center py-5">
            <i data-feather="clock" style="width: 48px; height: 48px; color: var(--text-muted);"></i>
            <h3 class="mt-3">No availability set</h3>
            <p class="text-muted">Add your available times so students can book sessions with you.</p>
            <a href="{% url 'sessions_app:add_availability' %}" class="btn btn-primary mt-3">
                <i data-feather="plus"></i> Add Time Slot
            </a>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Mobile Toggle Button -->
<button class="sidebar-toggle-mobile">
    <i data-feather="menu"></i>
</button>
<div class="sidebar-overlay"></div>
{% endblock %}
